pages:
  - name: Home-Server
    columns:
      - size: small
        widgets:
          - type: dns-stats
            title: Pi-hole stats
            service: pihole-v6
            url: http://192.168.178.10:8081
            password: 1234
            hour-format: 24h

          - type: server-stats
            title: Server stats
            
          - type: docker-containers
            title: Containers

      - size: full
        widgets:
          - type: monitor
            title: Service status
            cache: 1m
            sites:

            - title: Vaultwarden
              url: https://beelink.vault
              icon: si:vaultwarden
              allow-insecure: true
              check-url: https://beelink.vault/alive
              alt-status-codes: [200,301,302,307,401,403]
            
            - title: Immich
              url: http://192.168.178.10:2283
              icon: si:immich
              insecure: true
              check-url: http://192.168.178.10:2283
            
            - title: Nextcloud
              url: http://192.168.178.10:8082/apps/files/files
              icon: si:nextcloud
              insecure: true
              check-url: http://192.168.178.10:8082

            - title: Pi-hole
              url: http://192.168.178.10:8081/admin
              icon: si:pihole
              alt-status-codes: [403]

            - title: Wiki.js
              url: http://192.168.178.10:3001
              icon: si:wikipedia
              insecure: true
              check-url: http://192.168.178.10:3001
            
            - title: Home Assistant
              url: http://192.168.178.10:8123
              icon: si:homeassistant
              insecure: true
              check-url: http://192.168.178.10:8123

            - title: Grafana
              url: http://192.168.178.10:3000/dashboards
              icon: si:grafana
              insecure: true
              check-url: http://192.168.178.10:3000

            - title: Prometheus
              url: http://192.168.178.10:9090
              icon: si:prometheus
              insecure: true
              check-url: http://192.168.178.10:9090

            - title: Portainer
              url: http://192.168.178.10:9000
              icon: si:portainer
              insecure: true
              check-url: http://192.168.178.10:9000

            - title: Glances
              url: http://192.168.178.10:61208
              icon: si:gnome
              insecure: true
              check-url: http://192.168.178.10:61208

            - title: cAdvisor
              url: http://192.168.178.10:8080
              icon: si:docker
              insecure: true
              check-url: http://192.168.178.10:8080

            - title: Node Exporter
              url: http://192.168.178.10:9100
              icon: si:linux
              insecure: true
              check-url: http://192.168.178.10:9100

            - title: Blackbox Exporter
              url: http://192.168.178.10:9115
              icon: si:prometheus
              insecure: true
              check-url: http://192.168.178.10:9115

            - title: Promtail
              url: http://192.168.178.10:9080
              icon: si:logstash
              insecure: true

          - type: bookmarks
            title: Smart Plugs & Monitoring
            groups:
              - title: Tasmota Plugs
                color: 120 60 50
                links:
                  - title: Desk Plug
                    url: http://192.168.178.55/
                  - title: PC Plug
                    url: http://192.168.178.56/
                  - title: TV Plug
                    url: http://192.168.178.57/
                  - title: Server Plug
                    url: http://192.168.178.58/
                  - title: Bambu Plug
                    url: http://192.168.178.59/
                  - title: ?? Plug
                    url: http://192.168.178.60/
              - title: Grafana Dashboards
                color: 60 80 50
                links:
                  - title: Watt Usage 
                    url: http://192.168.178.10:3000/d/tasmota-energy/tasmota-plug-power?orgId=1&from=now-24h&to=now&timezone=browser&refresh=5s
                  - title: cAdvisor Exporter
                    url: http://192.168.178.10:3000/d/pMEd7m0Mz/cadvisor-exporter?orgId=1&from=now-6h&to=now&timezone=browser&var-host=$__all&var-container=$__all
                  - title: App Logs 
                    url: http://192.168.178.10:3000/d/sadlil-loki-apps-dashboard/logs-app?orgId=1&from=now-1h&to=now&timezone=browser&var-app=docker&var-search=
                  - title: Node Exporter
                    url: http://192.168.178.10:3000/d/rYdddlPWk/node-exporter-full?orgId=1&from=now-24h&to=now&timezone=browser&var-DS_PROMETHEUS=aertuvznphm9sb&var-job=node-exporter&var-nodename=0fa233a88be8&var-node=node-exporter:9100&var-diskdevices=%5Ba-z%5D%2B%7Cnvme%5B0-9%5D%2Bn%5B0-9%5D%2B%7Cmmcblk%5B0-9%5D%2B&refresh=1m

              - title: Router Access
                color: 0 70 50
                links:
                  - title: FRITZ!Box
                    url: https://fritz.box/#
          
          - type: custom-api
            title: Smart Plugs
            url: http://192.168.178.10:3500/status
            cache: 5s
            template: |
              <div style="font-family: sans-serif; font-size: 14px;">
                {{ $i := 0 }}
                {{ range .JSON.Array "" }}
                  {{ if eq (mod $i 3) 0 }}
                    {{ if ne $i 0 }}</div>{{ end }}
                    <div style="display: flex; gap: 12px; margin-bottom: 12px;">
                  {{ end }}
                  <div style="flex: 1; padding: 8px 12px; border-radius: 8px; background: #1e1e1e;">
                    <div style="font-weight: bold; font-size: 15px; margin-bottom: 4px;">
                      <a href="{{ .String "url" }}" target="_blank" style="text-decoration: none; color: #00bfff;">{{ .String "name" }}</a>
                    </div>
                    <div style="margin-bottom: 6px;">State: 
                      <span style="color: {{ if eq (.String "state") "ON" }}#4caf50{{ else }}#f44336{{ end }};">
                        {{ .String "state" }}
                      </span>
                    </div>
                    <div>
                      <a href="http://192.168.178.10:3500/toggle?ip={{ .String "ip" }}" target="_blank" style="display: inline-block; padding: 6px 14px; font-weight: bold; border-radius: 16px; text-decoration: none; font-size: 13px; background-color: #444; color: #fff; border: 1px solid #888;">
                        Toggle
                      </a>
                    </div>
                  </div>
                  {{ $i = add $i 1 }}
                {{ end }}
                </div>
              </div>

      - size: small
        widgets:
          - type: custom-api
            title: Disk Usage
            url: "http://192.168.178.10:8000"
            cache: 1m
            template: |
              <div style="font-family: monospace; font-size: 14px;">
                <div style="margin-bottom: 12px;">
                  <strong>Root</strong><br/>
                  <div class="color-highlight size-h3">{{ .JSON.String "root.used" }} / {{ .JSON.String "root.total" }} ({{ .JSON.Int "root.percent" }} %)</div>
                  <div style="background: #333; width: 100%; height: 8px; border-radius: 4px; overflow: hidden;">
                    <div style="background: #999; width: {{ .JSON.Int "root.percent" }}%; height: 8px;"></div>
                  </div>
                </div>

                <div>
                  <strong>Immich</strong><br/>
                  <div class="color-highlight size-h3">{{ .JSON.String "immich.used" }} / {{ .JSON.String "immich.total" }} ({{ .JSON.Int "immich.percent" }} %)</div>
                  <div style="background: #333; width: 100%; height: 8px; border-radius: 4px; overflow: hidden;">
                    <div style="background: #999; width: {{ .JSON.Int "immich.percent" }}%; height: 8px;"></div>
                  </div>
                </div>
              </div>
          
          - type: custom-api
            title: Immich stats
            cache: 1d
            url: http://192.168.178.10:2283/api/server/statistics
            headers:
              x-api-key: FWf1IbsDpf2xAdNTju0Beo49fkb7U3fER1IxOqy2C0
              Accept: application/json
            template: |
              <div class="flex justify-between text-center">
                <div>
                    <div class="color-highlight size-h3">{{ .JSON.Int "photos" | formatNumber }}</div>
                    <div class="size-h6">PHOTOS</div>
                </div>
                <div>
                    <div class="color-highlight size-h3">{{ .JSON.Int "videos" | formatNumber }}</div>
                    <div class="size-h6">VIDEOS</div>
                </div>
                <div>
                    <div class="color-highlight size-h3">{{ div (.JSON.Int "usage" | toFloat) 1073741824 | toInt | formatNumber }}GB</div>
                    <div class="size-h6">USAGE</div>
                </div>
              </div>
          
          - type: custom-api
            title: Current watt usage
            cache: 5s
            url: "http://192.168.178.10:9090/api/v1/query?query=sum%20by%20(source)(tasmota_status_sns_energy_power%7Bjob%3D%22tasmota%22%2Csource%3D~%22stat/(desk|pc|tv|server|bambu)%22%7D)"
            template: |
              <div style="font-family: monospace; font-size: 14px; padding: 4px 8px;">
                <table style="width: 100%;">
                  {{ range .JSON.Array "data.result" }}
                    {{ $src := .String "metric.source" }}
                    {{ $val := .Float "value.1" }}
                    {{ $label := "" }}
                    {{ if eq $src "stat/desk" }}{{ $label = "Desk" }}{{ end }}
                    {{ if eq $src "stat/pc" }}{{ $label = "PC" }}{{ end }}
                    {{ if eq $src "stat/tv" }}{{ $label = "TV" }}{{ end }}
                    {{ if eq $src "stat/server" }}{{ $label = "Server" }}{{ end }}
                    {{ if eq $src "stat/bambu" }}{{ $label = "Bambu" }}{{ end }}
                    {{ if $label }}
                      <tr>
                        <td>{{ $label }}</td>
                        <td style="text-align: right;" class="color-highlight size-h3">{{ printf "%.0f" $val }} W</td>
                      </tr>
                    {{ end }}
                  {{ end }}
                </table>
              </div>
          
          
